---
- name: Validate server authentication input provided by user
  when:
  - (auth_token is not defined)
  ansible.builtin.fail:
    msg: "auth_token is mandatory"

  register: user_privileges

- register: result
  hpe.ilo.ilo_manage:
    category: Systems
    command: CheckUserPrivileges
    baseuri: "{{ baseuri }}"
    auth_token: "{{ auth_token }}"
    required_permissions: "{{ required_permissions | default(['HostBIOSConfigPriv', 'HostNICConfigPriv', 'HostStorageConfigPriv']) }}"

